<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>星球命名故事 (互動式)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0a0a2a; /* 深藍色星空背景 */
            color: #f0f0f0;
        }
        /* 灑上一些星星背景 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(white 1px, transparent 1px), radial-gradient(white 1px, transparent 1px);
            background-size: 40px 40px, 40px 40px;
            background-position: 0 0, 20px 20px;
            animation: twinkle 5s infinite linear;
            z-index: -1;
        }
        @keyframes twinkle {
            from { opacity: 0.3; }
            to { opacity: 0.7; }
        }

        /* 翻轉卡片效果 */
        .card-container {
            perspective: 1000px;
        }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.7s;
            transform-style: preserve-3d;
        }
        .card-container.is-flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden; /* Safari */
            backface-visibility: hidden;
            border-radius: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        .card-front {
            background: linear-gradient(145deg, #2a2a6a, #1a1a4a);
            border: 2px solid #4a4a8a;
            cursor: pointer;
        }
        .card-back {
            background: linear-gradient(145deg, #3a3a7a, #2a2a5a);
            border: 2px solid #5a5a9a;
            transform: rotateY(180deg);
            overflow-y: auto;
        }

        /* --- 全新注音排版系統 (使用 Flexbox) --- */
        .zhuyin-wrap {
            display: inline-flex; /* 使用 Flexbox 進行排版 */
            align-items: center;  /* 垂直置中對齊 */
            line-height: 1.2;     /* 避免繼承的行高影響排版 */
            vertical-align: middle; /* 確保與旁邊的文字對齊 */
        }
        .base-char {
            /* 國字本身不需要特別樣式，它會繼承父層的字體大小 */
        }
        .phonetic {
            writing-mode: vertical-rl;
            text-orientation: upright;
            -webkit-writing-mode: vertical-rl;
            -webkit-text-orientation: upright;
            font-size: 0.45em; /* 調整注音大小 */
            color: #c0c0ff;
            margin-left: 0.1em; /* 與國字的間距 */
            letter-spacing: 0.1em;
        }
        .tone {
            font-size: 0.5em; /* 調整聲調大小 */
            color: #c0c0ff;
            margin-left: 0.05em; /* 與注音的間距 */
            line-height: 1;
        }
        /* --- 舊的 ruby 樣式已完全移除 --- */
        
        /* 標點符號樣式 */
        .punct {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0 0.2em;
            font-size: inherit;
        }

        .quiz-option {
            transition: all 0.2s ease-in-out;
        }
        .quiz-option:hover:not(:disabled) {
            transform: scale(1.05);
            background-color: #4a4a8a;
        }
        
        /* 分數彈跳視窗樣式 */
        #score-modal {
            transition: opacity 0.3s ease-in-out;
        }
        #score-modal > div {
             transform: scale(0.95);
             transition: transform 0.3s ease-in-out;
        }
        #score-modal:not(.hidden) > div {
            transform: scale(1);
        }
        
        /* --- 手機版響應式設計 (Responsive Design) - 使用新版注音系統 --- */
        @media (max-width: 640px) {
            /* 縮小主標題和副標題 */
            #main-title {
                font-size: 2rem; 
                line-height: 2.4rem;
            }
             header p {
                font-size: 0.95rem;
            }

            /* 增加卡片高度，並大幅縮小卡片標題字體 */
            .card-container {
                height: 16rem; 
            }
            .card-front h2, .card-back h3 {
                font-size: 1.6rem;
            }
             .card-back p {
                font-size: 0.9rem;
                line-height: 1.6;
            }

            /* 專為手機微調新版注音的大小 */
            .phonetic {
                font-size: 0.42em;
            }
            .tone {
                font-size: 0.48em;
            }

            /* 縮小閱讀區和測驗區的標題與字體 */
            #reading-section h2, #quiz-section h2 {
                font-size: 1.75rem;
            }
            #reading-section, #quiz-section {
                font-size: 0.9rem;
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-10">
            <h1 id="main-title" class="text-4xl sm:text-5xl font-bold text-yellow-300 mb-2">
                <!-- JavaScript will populate this -->
            </h1>
            <p class="text-lg text-gray-300">哈囉<span class="punct">，</span>小朋友<span class="punct">！</span>點擊下方的行星卡片<span class="punct">，</span>來看看它名字背後的故事吧<span class="punct">！</span></p>
        </header>

        <!-- 行星卡片區 -->
        <main id="planets-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
            <!-- JavaScript 會在這裡生成行星卡片 -->
        </main>
        
        <!-- 天文閱讀區 -->
        <section id="reading-section" class="mt-16 bg-slate-800/50 p-6 rounded-2xl max-w-3xl mx-auto">
            <h2 id="reading-title" class="text-3xl font-bold text-center mb-6 text-yellow-300">
                <!-- JS populates -->
            </h2>
            <div class="space-y-6 text-lg">
                <div>
                    <h3 id="wuxing-title" class="text-xl font-semibold text-cyan-300 mb-2">
                        <!-- JS populates -->
                    </h3>
                    <ul class="list-disc list-inside space-y-2">
                        <li id="wuxing-mu"></li>
                        <li id="wuxing-huo"></li>
                        <li id="wuxing-tu"></li>
                        <li id="wuxing-jin"></li>
                        <li id="wuxing-shui"></li>
                    </ul>
                </div>
                <div>
                    <h3 id="naming-title" class="text-xl font-semibold text-cyan-300 mb-2">
                        <!-- JS populates -->
                    </h3>
                    <p id="naming-p1" class="leading-relaxed tracking-wider"></p>
                    <p id="naming-p2" class="leading-relaxed tracking-wider mt-4"></p>
                    <p id="naming-p3" class="leading-relaxed tracking-wider mt-4"></p>
                    <ul class="list-none space-y-2 mt-4 pl-4 border-l-2 border-cyan-400">
                         <li id="uranus-info"></li>
                         <li id="neptune-info"></li>
                         <li id="pluto-info"></li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- 小測驗區 -->
        <section id="quiz-section" class="mt-16 bg-slate-800/50 p-6 rounded-2xl max-w-3xl mx-auto">
            <h2 id="quiz-title" class="text-3xl font-bold text-center mb-6 text-yellow-300">
                <!-- JavaScript will populate this -->
            </h2>
            <div id="quiz-container" class="space-y-8">
                <!-- JavaScript 會在這裡生成測驗問題 -->
            </div>
            <div class="text-center mt-8">
                <button id="reset-quiz-btn" class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-6 rounded-lg transition-colors">
                    重新作答
                </button>
            </div>
        </section>

        <footer class="text-center mt-16 text-gray-500 text-sm">
            <p class="mb-2">有趣的宇宙<span class="punct">，</span>等著你去發現喔<span class="punct">！</span></p>
            <p>&copy; 2025 | Designed by Cybill Wang | cybill31@gmail.com</p>
        </footer>
    </div>

    <!-- 分數彈跳視窗 (Modal) -->
    <div id="score-modal" class="fixed inset-0 bg-black bg-opacity-75 items-center justify-center z-50 hidden">
        <div class="bg-slate-800 p-8 rounded-2xl text-center shadow-2xl border-2 border-yellow-300 w-11/12 max-w-md">
            <h2 id="modal-title" class="text-3xl font-bold text-yellow-300 mb-4"></h2>
            <p class="text-lg mb-6">你答對了 <span id="final-score" class="font-bold text-2xl text-cyan-300"></span> / 7 題</p>
            <button id="close-modal-btn" class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-6 rounded-lg">關閉</button>
        </div>
    </div>
    
    <script>
        const planetsData = [
            { name: "水星", zhuyin: "ㄕㄨㄟˇ ㄒㄧㄥ", eng: "Mercury", color: "bg-gray-400", story: "在羅馬神話裡，有一位跑得非常快的信差之神，叫做「墨丘利」。他的腳上有一雙長了翅膀的特別鞋子，可以咻一下地飛到任何地方。水星是太陽系裡跑得最快的一顆行星，所以人們就用他的名字來稱呼它了。" },
            { name: "金星", zhuyin: "ㄐㄧㄣ ㄒㄧㄥ", eng: "Venus", color: "bg-yellow-200", story: "「維納斯」是羅馬神話中最有名的愛與美之神，她非常的美麗。金星是夜空中除了月亮之外最亮的一顆星，看起來就像一顆閃閃發光的鑽石，所以就用了最美麗的女神「維納斯」的名字來命名。" },
            { name: "地球", zhuyin: "ㄉㄧˋ ㄑㄧㄡˊ", eng: "Earth", color: "bg-blue-500", story: "我們所居住的這顆美麗藍色星球，它的名字很特別喔！它不是來自羅馬或希臘神話。地球的英文名字 \"Earth\"，是從古老的日耳曼語演變而來的，意思就是「土地」或是「地面」。" },
            { name: "火星", zhuyin: "ㄏㄨㄛˇ ㄒㄧㄥ", eng: "Mars", color: "bg-red-500", story: "「馬爾斯」是羅馬神話中勇猛的「戰神」。火星的表面因為有很多紅色的沙子和石頭，所以整顆星球看起來都紅通通的，就像火焰的顏色一樣。因此，人們就用英勇的戰神「馬爾斯」來為它命名。" },
            { name: "木星", zhuyin: "ㄇㄨˋ ㄒㄧㄥ", eng: "Jupiter", color: "bg-orange-400", story: "「朱比特」是羅馬神話裡的「眾神之王」，就像是所有神仙的國王一樣。木星是太陽系行星家族中的「巨無霸」，體積比其他所有行星加起來還要大！所以要用最有氣勢的眾神之王「朱比特」來命名才行！" },
            { name: "土星", zhuyin: "ㄊㄨˇ ㄒㄧㄥ", eng: "Saturn", color: "bg-yellow-500", story: "「薩圖恩」是羅馬神話中的「農業之神」。土星最特別的地方，就是它身上那一圈美麗的「行星環」，讓它看起來就像戴著一個漂亮的呼拉圈。在古代，土星是人們用肉眼能看到最遠的行星，所以就用了這位重要的神來命名。" },
            { name: "天王星", zhuyin: "ㄊㄧㄢ ㄨㄤˊ ㄒㄧㄥ", eng: "Uranus", color: "bg-cyan-300", story: "這是科學家用望遠鏡才發現的行星。它的名字來自希臘神話中的「天空之神」——烏拉諾斯。他是天空的化身，也是眾神之王朱比特的爺爺喔！用天空之神來為這顆淡藍色的星球命名，是不是很夢幻呢？" },
            { name: "海王星", zhuyin: "ㄏㄞˇ ㄨㄤˊ ㄒㄧㄥ", eng: "Neptune", color: "bg-blue-700", story: "海王星是一顆非常漂亮的深藍色星球，就像一片浩瀚又神秘的大海洋。所以，人們就用了羅馬神話中掌管海洋的「海神」——尼普頓來為它命名。神話裡的海神手上總是拿著一把強大的三叉戟。" },
            { name: "冥王星", zhuyin: "ㄇㄧㄥˊ ㄨㄤˊ ㄒㄧㄥ", eng: "Pluto", color: "bg-indigo-300", story: "「普魯托」是羅馬神話中，掌管遙遠又神秘的地底世界的神。因為冥王星距離太陽非常遙遠，那裡又冷又暗，所以人們就用了冥王「普魯托」的名字來稱呼它。現在它被歸類為「矮行星」喔！" }
        ];

        const quizData = [
            {
                question: "跑得最快的「信差之神」，是哪顆星的名字由來？",
                options: ["金 星 Venus", "水 星 Mercury", "火 星 Mars"],
                answer: "水 星 Mercury"
            },
            {
                question: "太陽系中最大顆的「巨 無 霸」行星，是用哪位神仙的名字命名的？",
                options: ["戰神 馬爾斯 (Mars)", "海神 尼普頓 (Neptune)", "眾神之王 朱比特 (Jupiter)"],
                answer: "眾神之王 朱比特 (Jupiter)"
            },
            {
                question: "哪一顆行星的名字不是來自神話故事，而是「土 地」的意思？",
                options: ["土 星 Saturn", "地 球 Earth", "天王星 Uranus"],
                answer: "地 球 Earth"
            },
            {
                question: "哪一種 顏色 代表「火」？",
                options: ["黃 色", "紅 色", "黑 色"],
                answer: "紅 色"
            },
            {
                question: "司馬遷幫五顆星星取了什麼名字？",
                options: ["日、月、星、雲、風", "金 星、木 星、水 星、火 星、土 星", "春、夏、秋、冬、風"],
                answer: "金 星、木 星、水 星、火 星、土 星"
            },
            {
                question: "土星對應的顏色是什麼？",
                options: ["黃 色", "白 色", "綠 色"],
                answer: "黃 色"
            },
            {
                question: "為什麼古代人看不到 天王星 和 海王星？",
                options: ["星球太小了", "星球距離地球太遙遠了", "星球跑太快了"],
                answer: "星球距離地球太遙遠了"
            }
        ];

        const planetsGrid = document.getElementById('planets-grid');
        const quizContainer = document.getElementById('quiz-container');
        
        // 計分相關變數
        let score = 0;
        let questionsAnswered = 0;
        const totalQuestions = quizData.length;

        // --- 全新核心功能：使用 Flexbox 格式化注音 (取代舊的 ruby 寫法) ---
        function formatZhuyin(name, zhuyin) {
            const nameChars = name.split('');
            const zhuyinParts = zhuyin.split(' ');
            let html = '';

            nameChars.forEach((char, i) => {
                const zhuyinPart = zhuyinParts[i] || '';
                // 只匹配需要獨立出來的二、三、四聲
                const toneMatch = zhuyinPart.match(/[ˇˊˋ]/);
                let phonetics, toneHTML = '';

                if (toneMatch) {
                    toneHTML = `<span class="tone">${toneMatch[0]}</span>`;
                    phonetics = zhuyinPart.replace(toneMatch[0], '');
                } else {
                    phonetics = zhuyinPart;
                }
                
                // 使用 span 和 Flexbox 來組合國字、注音和聲調
                html += `<span class="zhuyin-wrap">` +
                          `<span class="base-char">${char}</span>` +
                          `<span class="phonetic">${phonetics}</span>` +
                          `${toneHTML}` +
                        `</span>`;
            });
            return html;
        }

        // 生成行星卡片
        planetsData.forEach(planet => {
            const zhuyinRuby = formatZhuyin(planet.name, planet.zhuyin);

            const cardContainer = document.createElement('div');
            cardContainer.className = 'card-container h-64';
            cardContainer.innerHTML = `
                <div class="card-inner">
                    <div class="card-front">
                        <div class="w-24 h-24 ${planet.color} rounded-full mb-4 shadow-lg flex items-center justify-center">
                           <!-- 可以放SVG圖標等 -->
                        </div>
                        <h2 class="text-3xl font-bold">${zhuyinRuby}</h2>
                    </div>
                    <div class="card-back">
                        <div class="flex flex-col h-full p-2 text-left">
                            <h3 class="text-xl font-bold mb-2 text-center">${zhuyinRuby}</h3>
                            <p class="text-base leading-relaxed tracking-wider flex-grow">${planet.story}</p>
                            <p class="text-gray-400 text-sm mt-2 text-right">英文名字: ${planet.eng}</p>
                        </div>
                    </div>
                </div>
            `;
            cardContainer.addEventListener('click', () => {
                cardContainer.classList.toggle('is-flipped');
            });
            planetsGrid.appendChild(cardContainer);
        });

        // 生成測驗問題
        function generateQuiz() {
             score = 0;
             questionsAnswered = 0;
             quizContainer.innerHTML = ''; // 清空舊題目
             quizData.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-block';
                
                let optionsHTML = '';
                q.options.forEach(option => {
                    optionsHTML += `<button class="quiz-option w-full text-left bg-slate-700 p-3 rounded-lg" data-question="${index}" data-answer="${option}">${option}</button>`;
                });
                
                let formattedQuestion = '';
                q.question.split('').forEach(char => {
                     if ('，。！？「」'.includes(char)) {
                        formattedQuestion += `<span class="punct">${char}</span>`;
                    } else {
                        formattedQuestion += char;
                    }
                });

                questionDiv.innerHTML = `
                    <p class="text-lg mb-4">${index + 1}. ${formattedQuestion}</p>
                    <div class="options-grid grid grid-cols-1 gap-3">
                        ${optionsHTML}
                    </div>
                    <p class="result-text mt-2 h-6 text-green-400"></p>
                `;
                quizContainer.appendChild(questionDiv);
            });
        }

        function showScoreModal() {
            const modal = document.getElementById('score-modal');
            const finalScoreSpan = document.getElementById('final-score');
            const modalTitle = document.getElementById('modal-title');
            
            finalScoreSpan.textContent = score;
            if (score === totalQuestions) {
                modalTitle.textContent = '太厲害了！全對！';
            } else if (score >= totalQuestions / 2) {
                modalTitle.textContent = '測驗完成！';
            } else {
                 modalTitle.textContent = '再接再厲！';
            }
            
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }
       
        // 測驗邏輯
        quizContainer.addEventListener('click', function(e) {
            if (e.target.classList.contains('quiz-option') && !e.target.disabled) {
                const questionIndex = e.target.dataset.question;
                const selectedAnswer = e.target.dataset.answer;
                const correctAnswer = quizData[questionIndex].answer;
                const questionBlock = e.target.closest('.question-block');
                const resultText = questionBlock.querySelector('.result-text');
                const allOptions = questionBlock.querySelectorAll('.quiz-option');

                allOptions.forEach(btn => {
                    btn.disabled = true; // 回答後禁用所有按鈕
                    if(btn.dataset.answer === correctAnswer) {
                        btn.style.backgroundColor = '#22c55e'; // 正確答案變綠色
                    }
                });

                if (selectedAnswer === correctAnswer) {
                    resultText.textContent = '答對了，你好棒！';
                    resultText.style.color = '#4ade80';
                } else {
                    e.target.style.backgroundColor = '#ef4444'; // 錯誤答案變紅色
                    resultText.textContent = `答錯了，正確答案是「${correctAnswer}」`;
                    resultText.style.color = '#f87171';
                }
            }
        });
        
        // 重新作答與關閉視窗邏輯
        const resetBtn = document.getElementById('reset-quiz-btn');
        const modal = document.getElementById('score-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        
        resetBtn.addEventListener('click', generateQuiz);
        
        closeModalBtn.addEventListener('click', () => {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        });

        // 點擊背景關閉視窗
        modal.addEventListener('click', (e) => {
            if(e.target.id === 'score-modal') {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
        });
        
        // --- 頁面初始載入 ---
        
        // 標題
        document.getElementById('main-title').innerHTML = formatZhuyin("星星的名字故事", "ㄒㄧㄥ ㄒㄧㄥ ˙ㄉㄜ ㄇㄧㄥˊ ㄗˋ ㄍㄨˋ ㄕˋ");
        document.getElementById('quiz-title').innerHTML = formatZhuyin("星際小測驗", "ㄒㄧㄥ ㄐㄧˋ ㄒㄧㄠˇ ㄘㄜˋ ㄧㄢˋ");
        
        // 天文閱讀區 (移除注音)
        document.getElementById('reading-title').innerHTML = `🌟 小博士 天文閱讀區 🌟`;
        document.getElementById('wuxing-title').innerHTML = `東方文化中的「五行」和五個顏色對照：`;
        document.getElementById('wuxing-mu').innerHTML = `木 = 青（綠色的樹木）`;
        document.getElementById('wuxing-huo').innerHTML = `火 = 赤（紅色，像火焰一樣）`;
        document.getElementById('wuxing-tu').innerHTML = `土 = 黃（土地、泥巴的顏色）`;
        document.getElementById('wuxing-jin').innerHTML = `金 = 白（像金屬發亮的白光）`;
        document.getElementById('wuxing-shui').innerHTML = `水 = 黑（深暗的水色）`;
        
        document.getElementById('naming-title').innerHTML = `中文命名的由來：`;
        document.getElementById('naming-p1').innerHTML = `很久以前，人們觀察天空，看到太陽、月亮，還有五顆會移動的星星。西漢的天文學家司馬遷，把這五顆星星和「五行」的想法連在一起，取了名字： 金星、木星、水星、火星、土星。`;
        document.getElementById('naming-p2').innerHTML = `以前的人，因為沒有先進的望遠鏡，只能看得到土星以內的行星（水星到土星）。天王星、海王星和冥王星這些更遠的星星，是後來有了更好的觀察工具和科技，才一個一個被發現的。`;
        
        document.getElementById('uranus-info').innerHTML = `天王星（1781 發現）→ 清朝乾隆年間，最早翻譯為「歲星」之外的新星，後來在清末被定名為 天王星。`;
        document.getElementById('neptune-info').innerHTML = `海王星（1846 發現）→ 清朝咸豐年間，西方傳入中國後翻譯為 海王星。`;
        document.getElementById('pluto-info').innerHTML = `冥王星（1930 發現）→ 民國時期，由天文學家馬仲華（北京大學教授）等人翻譯為 冥王星。`;

        // 首次載入時生成測驗
        generateQuiz();

    </script>
</body>
</html>




